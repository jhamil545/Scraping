<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">  
  <link rel="shortcut icon" href="./img/fav.png" type="image/x-icon">  
  <link rel="stylesheet" href="https://kit-pro.fontawesome.com/releases/v5.12.1/css/pro.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='dashboard/css/style.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <title>Welcome To Cleopatra</title>
</head>
<body class="bg-gray-100">

<!-- start navbar -->
<div class="md:fixed md:w-full md:top-0 md:z-20 flex flex-row flex-wrap items-center bg-white p-6 border-b border-gray-300">

    <!-- logo -->
    <div class="flex-none w-56 flex flex-row items-center">
      <img src="img/logo.png" class="w-10 flex-none">
      <strong class="capitalize ml-1 flex-1">PANEL DE CONTROL</strong>

      <button id="sliderBtn" class="flex-none text-right text-gray-900 hidden md:block">
        <i class="fad fa-list-ul"></i>
      </button>
    </div>
    <!-- end logo -->

    <!-- navbar content toggle -->
    <button id="navbarToggle" class="hidden md:block md:fixed right-0 mr-6">
      <i class="fad fa-chevron-double-down"></i>
    </button>
    <!-- end navbar content toggle -->

    <!-- navbar content -->
    <div id="navbar" class="animated md:hidden md:fixed md:top-0 md:w-full md:left-0 md:mt-16 md:border-t md:border-b md:border-gray-200 md:p-10 md:bg-white flex-1 pl-3 flex flex-row flex-wrap justify-between items-center md:flex-col md:items-center">
      <!-- left -->
      <div class="text-gray-600 md:w-full md:flex md:flex-row md:justify-evenly md:pb-10 md:mb-10 md:border-b md:border-gray-200">
        <a class="mr-2 transition duration-500 ease-in-out hover:text-gray-900" href="#" title="email"><i class="fad fa-envelope-open-text"></i></a>
        <a class="mr-2 transition duration-500 ease-in-out hover:text-gray-900" href="#" title="email"><i class="fad fa-comments-alt"></i></a>
        <a class="mr-2 transition duration-500 ease-in-out hover:text-gray-900" href="#" title="email"><i class="fad fa-check-circle"></i></a>
        <a class="mr-2 transition duration-500 ease-in-out hover:text-gray-900" href="#" title="email"><i class="fad fa-calendar-exclamation"></i></a>
      </div>
      <!-- end left -->

      <!-- right -->
      <div class="flex flex-row-reverse items-center">

        <!-- user -->
        <div class="dropdown relative md:static">
          <button class="menu-btn focus:outline-none focus:shadow-outline flex flex-wrap items-center">
            <div class="w-8 h-8 overflow-hidden rounded-full">
              <img class="w-full h-full object-cover" src="img/user.svg">
            </div>

            <div class="ml-2 capitalize flex ">
              <h1 class="text-sm text-gray-800 font-semibold m-0 p-0 leading-none">moeSaid</h1>
              <i class="fad fa-chevron-down ml-2 text-xs leading-none"></i>
            </div>
          </button>

          <button class="hidden fixed top-0 left-0 z-10 w-full h-full menu-overflow"></button>

          <div class="text-gray-500 menu hidden md:mt-10 md:w-full rounded bg-white shadow-md absolute z-20 right-0 w-40 mt-5 py-2 animated faster">
            <a class="px-4 py-2 block capitalize font-medium text-sm tracking-wide bg-white hover:bg-gray-200 hover:text-gray-900 transition-all duration-300 ease-in-out" href="#">
              <i class="fad fa-user-edit text-xs mr-1"></i>
              edit my profile
            </a>
            <a class="px-4 py-2 block capitalize font-medium text-sm tracking-wide bg-white hover:bg-gray-200 hover:text-gray-900 transition-all duration-300 ease-in-out" href="#">
              <i class="fad fa-inbox-in text-xs mr-1"></i>
              my inbox
            </a>
            <a class="px-4 py-2 block capitalize font-medium text-sm tracking-wide bg-white hover:bg-gray-200 hover:text-gray-900 transition-all duration-300 ease-in-out" href="#">
              <i class="fad fa-badge-check text-xs mr-1"></i>
              tasks
            </a>
            <a class="px-4 py-2 block capitalize font-medium text-sm tracking-wide bg-white hover:bg-gray-200 hover:text-gray-900 transition-all duration-300 ease-in-out" href="#">
              <i class="fad fa-comment-alt-dots text-xs mr-1"></i>
              chats
            </a>
            <hr>
            <form action="{{ url_for('logout') }}" method="get">
              <button type="submit" class="px-4 py-2 block capitalize font-medium text-sm tracking-wide bg-white hover:bg-gray-200 hover:text-gray-900 transition-all duration-300 ease-in-out">
                  <i class="fad fa-user-times text-xs mr-1"></i>
                  Log out
              </button>
            </form>
          </div>
        </div>
        <!-- end user -->

        <!-- notification -->
        <div class="dropdown relative mr-5 md:static">
          <button class="text-gray-500 menu-btn p-0 m-0 hover:text-gray-900 focus:text-gray-900 focus:outline-none transition-all ease-in-out duration-300">
            <i class="fad fa-bells"></i>
          </button>
          <button class="hidden fixed top-0 left-0 z-10 w-full h-full menu-overflow"></button>
          <div class="menu hidden rounded bg-white md:right-0 md:w-full shadow-md absolute z-20 right-0 w-84 mt-5 py-2 animated faster">
            <div class="px-4 py-2 flex flex-row justify-between items-center capitalize font-semibold text-sm">
              <h1>notifications</h1>
              <div class="bg-teal-100 border border-teal-200 text-teal-500 text-xs rounded px-1">
                <strong>5</strong>
              </div>
            </div>
            <hr>
            <!-- Notification items go here -->
            <div class="px-4 py-2 mt-2">
              <a href="#" class="border border-gray-300 block text-center text-xs uppercase rounded p-1 hover:text-teal-500 transition-all ease-in-out duration-500">
                view all
              </a>
            </div>
          </div>
        </div>
        <!-- end notification -->

        <!-- messages -->
        <div class="dropdown relative mr-5 md:static">
          <button class="text-gray-500 menu-btn p-0 m-0 hover:text-gray-900 focus:text-gray-900 focus:outline-none transition-all ease-in-out duration-300">
            <i class="fad fa-comments"></i>
          </button>
          <button class="hidden fixed top-0 left-0 z-10 w-full h-full menu-overflow"></button>
          <div class="menu hidden md:w-full md:right-0 rounded bg-white shadow-md absolute z-20 right-0 w-84 mt-5 py-2 animated faster">
            <div class="px-4 py-2 flex flex-row justify-between items-center capitalize font-semibold text-sm">
              <h1>messages</h1>
              <div class="bg-teal-100 border border-teal-200 text-teal-500 text-xs rounded px-1">
                <strong>3</strong>
              </div>
            </div>
            <hr>
            <!-- Message items go here -->
            <div class="px-4 py-2 mt-2">
              <a href="#" class="border border-gray-300 block text-center text-xs uppercase rounded p-1 hover:text-teal-500 transition-all ease-in-out duration-500">
                view all
              </a>
            </div>
          </div>
        </div>
        <!-- end messages -->

      </div>
      <!-- end right -->
    </div>
    <!-- end navbar content -->

</div>
<!-- end navbar -->

<!-- start wrapper -->
<div class="h-screen flex flex-row flex-wrap">

  <!-- start sidebar -->
  <div id="sideBar" class="relative flex flex-col flex-wrap bg-white border-r border-gray-300 p-6 flex-none w-64 md:fixed md:top-0 md:z-30 md:h-screen md:shadow-xl animated faster">
      
      <!-- sidebar content -->
      <div class="flex flex-col">

          <!-- sidebar toggle -->
          <div class="flex justify-end mb-5">
              <button id="sideBarHideBtn" class="text-gray-500 hover:text-gray-900">
                  <i class="fad fa-times"></i>
              </button>
          </div>

          <nav class="flex-1">
              <ul class="flex flex-col">
                  <li>
                      <a href="{{ url_for('dashboard.index') }}" class="flex items-center p-2 text-gray-900 hover:bg-gray-200 rounded">
                          <i class="fad fa-tachometer-alt"></i>
                          <span class="ml-2">Dashboard</span>
                      </a>
                  </li>
                  <li>
                      
                  </li>
                  <!-- Otros enlaces de navegación -->
              </ul>
          </nav>
      </div>
  </div>
  <!-- end sidebar -->

  <!-- ... El código existente ... -->

    <!-- start main content -->
    <div class="flex-1 ml-64 p-8">
      <div class="bg-white shadow-md rounded-lg p-7">
          <h2 class="text-lg font-semibold mb-4">Lista de Usuarios</h2>

          <!-- Start Search Filters -->
          <div class="mb-4 flex flex-col md:flex-row md:space-x-4">
            <div class="mb-4 flex space-x-4">
                <input type="text" id="searchTitle" placeholder="Buscar por nombre" class="border rounded p-2 flex-1">
                
                <input type="text" id="searchCategory" placeholder="Buscar por username" class="border rounded p-2 flex-1">
                <button id="searchBtn" class="bg-blue-500 text-black border rounded p-2">Buscar</button>

            </div>
          </div>
          
        
          <!-- End Search Filters -->

          <!-- Botón para exportar a CSV -->
          <div class="mb-4">
            <button id="exportCsvBtn" class="bg-green-500 text-black border rounded p-2">Exportar a CSV</button>
          </div>
          <!-- Botón para crear user -->
          <div class="mb-4">
            <button id="exportCsvBtn" class="bg-green-500 text-black border rounded p-2">Crear usuario</button>
          </div>

          <div class="overflow-x-auto" style="max-height: 500px; overflow-y: scroll;">
            <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
                <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                    <tr>
                        <th scope="col" class="px-6 py-3">USUARIO</th>
                        <th scope="col" class="px-6 py-3">CORREO</th>
                        <th scope="col" class="px-6 py-3">NOMBRE</th>
                        <th scope="col" class="px-6 py-3">APELLIDO</th>
                        <th scope="col" class="px-6 py-3">ROL</th>
                        <th scope="col" class="px-6 py-3">MEMBRESIA</th>
                        <th scope="col" class="px-6 py-3">Action</th>
                    </tr>
                </thead>
                <tbody id="articlesTableBody">
                    {% for user in users %}
                    <tr class="odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700">
                        <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                            {{ user.username }}
                        </th>
                        
                        <td class="px-6 py-4">
                            {{ user.email }}
                        </td>
                        
                        <td class="px-6 py-4">
                            {{ user.first_name }}
                        </td>
                        <td class="px-6 py-4">
                            {{ user.last_name }}
                        </td>
                        <td class="px-6 py-4">
                            {{ user.role }}
                        </td>
                        <td class="px-6 py-4">
                          {{ user.membership }}
                      </td>
                        <td class="px-6 py-4">
                          <!-- Botón Editar con fondo amarillo -->
                          <a href="/edituser/{{ user.id }}" class="inline-block px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-600">Editar</a>
                          
                          <!-- Formulario para Eliminar -->
                          <form action="/deleteuser/{{ user.id }}" method="POST" style="display:inline;">
                              <button type="submit" class="inline-block px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Eliminar</button>
                          </form>
                      </td>
                      
                      
                      
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="8" class="px-6 py-4 text-center">No user found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
      </div>
    </div>
    <!-- end main content -->
</div>
<!-- end wrapper -->


<!-- Script para manejar la búsqueda -->

<!-- 
<script>
  document.getElementById('searchBtn').addEventListener('click', function() {
  const titleFilter = document.getElementById('searchTitle').value.toLowerCase();
  
  const categoryFilter = document.getElementById('searchCategory').value.toLowerCase();
  
  const rows = document.querySelectorAll('#articlesTableBody tr');
  
  rows.forEach(row => {
      const title = row.querySelector('th').textContent.toLowerCase();
      
      const category = row.querySelector('td:nth-child(7)').textContent.toLowerCase(); // Assuming this is the category column

      const matchesTitle = title.includes(titleFilter);
      
      const matchesCategory = category.includes(categoryFilter);

      if (matchesTitle && matchesDate && matchesCategory) {
          row.style.display = '';
      } else {
          row.style.display = 'none';
      }
  });
});

</script> -->
<!-- Script para manejar la exportacion -->
<script>
  document.getElementById('exportCsvBtn').addEventListener('click', function() {
      const titleFilter = document.getElementById('searchTitle').value.toLowerCase();
      const dateFilter = document.getElementById('searchDate').value;
      const categoryFilter = document.getElementById('searchCategory').value.toLowerCase();

      // Construir la URL con los parámetros de filtro
      const exportUrl = `/dashboard/export_csv?title=${encodeURIComponent(titleFilter)}&date=${encodeURIComponent(dateFilter)}&category=${encodeURIComponent(categoryFilter)}`;
      
      // Redirigir a la URL de exportación
      window.location.href = exportUrl;
  });
</script>





<script>
document.getElementById('sidebarToggle').addEventListener('click', function() {
    const sidebar = document.getElementById('sideBar');
    sidebar.classList.toggle('hidden'); // Alterna la clase 'hidden'
});

document.getElementById('sideBarHideBtn').addEventListener('click', function() {
    const sidebar = document.getElementById('sideBar');
    sidebar.classList.add('hidden'); // Oculta el sidebar
});
</script>


<script src="{{ url_for('dashboard.static', filename='dashboard/js/scripts.js') }}"></script>

</body>
</html>
